# 开发帮助

## 1. 安装Chrome扩展开发工具

- [react-develop-tools](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi) 用于查看Redux历史消息和当前状态。

- [redux-devtools](https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd) 用于检查具体Component的props和state

## 2.关于component和container的区别

- container是带有connect修饰与redux数据相连接的组件，放在containers文件夹中(目前有许多container被错误地放在components文件夹中，将会逐步迁移)，container原则上应能直接不带参数使用，如

```jsx
...
<App>
  <Sidebar />
  <Main />
</App>
...
```

- component是高复用的组件，不依赖外部数据独立存在，放在components文件夹中，使用时通过props配置它的外观与行为， 如

```jsx
...
<Button onClick={this.click} size='lg' >
  <Icon name="add" width="16" height=“16” />
  Click me
</Button>
...
``` 

为了可复用性和可测试性，开发时优先选择Component组件，这样就可以用[storybook](https://storybook.js.org)本地快速调试组件在各种状态下的输出，无需连上服务器，Component开发完成后再开发container检查传递数据与生命周期行为的正确性。

开启storybook命令如下，成功后访问 <http://localhost:6006>

```bash
yarn run storybook
```

## 3.关于decorator

目前项目中有4个decorator,

- connect 参见 [react-redux](https://github.com/reduxjs/react-redux)

- translate 参见 [react-i18next](https://github.com/i18next/react-i18next)

- errorBoundary [项目内代码链接](https://github.com/pintia/sparkling-daydream/blob/master/client/src/utils/errorBoundary.jsx) 基于React 16新出的[error-boundaries](https://reactjs.org/docs/error-boundaries.html#introducing-error-boundaries) 

- reduxForm 参见[redux-form](https://redux-form.com)

建议使用顺序 `translate` -> `connect` -> `reduxForm` -> `errorBoundary`， 如引入新的第三方decorator，建议errorBoundary放在最里面以捕捉尽可能详细的错误信息。

```jsx
@translate('all', { wait: true })
@connect(mapUserProps(mapStateToProps), mapDispatchToProps)
@reduxForm({ form: 'XXXXForm' })
@errorBoundary()
export default class A extends React.Component {
  ...
} 
```

### 关于代码长度

过长的代码容易导致错误，也不利于review和debug，建议单个文件代码长度不要大于200行，单次PR修改行数不要超过1000行。如有功能涉及大量的更改，可以分批提交，未完成的行为和界面分别用alert和placeholder代替。

## 常用链接

相关第三方库文档

- [react](https://reactjs.org)
- [redux](https://github.com/reduxjs/redux)
- [lodash](https://lodash.com/docs)
- [redux-form](https://redux-form.com)
- [normalizer](https://github.com/paularmstrong/normalizr)
- [bootstrap](https://getbootstrap.com)
- [reactstrap](https://reactstrap.github.io)

其他文档

- [MDN](https://developer.mozilla.org/en-US/docs/Web)
- [CanIUse](https://www.caniuse.com)